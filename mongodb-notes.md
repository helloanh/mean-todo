## Introduction to MongoDB

### NoSql

+ scaling problems in object-relational mappers and SQL  
+ proposed storage solutions for simple querying and horizontal scaling:    

		+ key-value storage    
		+ column, object storage  
		+ most popular is document storage  

+ document-oriented db stores data in standard formats such as JSON and XML, and not in hierarchical object/tables  

+ MongoDB is the most popular document-oriented db    

### Key Features of MongoDB  

#### 1. The Binary JSON (BSON) Format  

+ binary-encoded serialization of JSON-like documents  
+ efficient in size and speed  
+ simple data structure representation of obj and arrays in key-value formats  
+ use of **_id** field as primary key  
+ ObjectId field is generated by the app driver or by the **mongod** service  
+ in the event the driver fails to provide the _id field with a unique ObjectId,  the mongod service will add it automatically using:  
	+ 4 byte value using seconds since the Unix epoch  
	+ 3 byte machine identifier  
	+ 2 byte process ID  
	+ 3 byte counter, starting with a rand value  

for example  

``` javascript
{
	"_id": ObjectId{"52d02240e4b01d67d71ad577"},
	"tittle": "First blog post",
	"comments": [
		...
	]
}

```

+ the BSON format allows mongoDB to internally index and map doc properties and even nested doc  

#### 2. MongoDB indexing  

+ uses predefined index to map doc fields and tell the engine which docs are compatible with this query statement  

```
{
	"_id": ObjectId("52d....577"),
	"title": "First Blog Post",
	"comments": [
		...
	],
	"commentsCount": 12
}
```

query to request documents with more than 10 comments:   

``` javascript
	db.posts.find({commentsCount: {$gt: 10} });
```

#### 3. Replica Set  

+  mongodb uses architecture replica set to protect data from hardware failure and increase read capacity  

+  a replace set is a set of mongoDB services that host the same dataset  

+  one service is used as the primary and other are secondaries  

+  all sets support read operation, but only the primary set can write  

+  has automatic failover feature  - when one of the set members can't reach the primary instance for more than 10 secs, the replica set will automatically elect and promote a secondary instance as the new primary  

+  replication is a robust feat of mongoDb  

#### 3. Sharding  

+  vertical scaling is easier since it consists of increasing a single machine resources -- ie. RAM, CPU, to handle the load  
		+  more expensive compared to splitting load on multiple machines  
		+  Popular cloud hosting providers limit the size of the machine instances you can use  


+  horizontal scaling with multiple machines  provide better overall performance  

+ mongoDB supports horizontal scaling  

### Mongoose  

Mongoose is a Object Relational Mapping (ODM) node.js module  to support Express application  

+  uses schemas to model entities  
+  goal is to bridge the gap btw MongoDB schemaless approach and the requirements of real-world app development  
 



